C  THIS PROGRAM CALCULATES THE ELECTRON DENSITY AROUND VENUS AS A FUNCTION
C  OF SOLAR ZENITH ANGLE AND ALTITUDE 
      SUBROUTINE FSMOD(DEN,ALT,SZA)
      DIMENSION P(26)
      DATA P(1)/0./
C  ALT IS THE ALTITUDE IN KILOMETERS
C  SZA IS THE SOLAR ZENITH ANGLE IN RADIANS
C  DEN IS THE BASE 10 LOG OF THE MODEL ELECTRON DENSITY IN NO/CC
      REAL M
      IF(P(1).NE.0.)GO TO 5
      OPEN(UNIT=7,NAME='FSMOD.DAT',TYPE='OLD',READONLY,SHARED)
      READ(7,*)P
      CLOSE(UNIT=7)
    5 CONTINUE
      S2=SIN(SZA)**2
      SZAP=SZA*(1.-P(23)*S2*EXP(-P(24)*S2-P(25)*(ALT
     1 -P(26))**2))
      SINZ=SIN(P(18)+SZAP)
      S=P(1)+P(2)/(ALT-P(3))
     1 + SINZ*P(13)
     2 + P(19)*EXP(-P(20)*((ALT-P(21))**2)-P(22)*SZAP**2)
      O=P(4)+P(5)/(ALT-P(6))
     1  +SINZ*P(14)
      C=P(7)+P(8)/(ALT-P(9))
     1 +SINZ*P(15)
      M=P(10)+P(11)/(ALT-P(12))
     1 +SINZ*P(16)
      SS=S*COS(P(17)+SZAP)
      CALC=(1.77245*SS*ERFC(-SS)+EXP(-SS*SS)+O)
      IF(CALC.LE.0.)CALC=.00001
      DEN=C+M*ALOG(CALC)
      RETURN
      END
